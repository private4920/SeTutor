{"version":3,"sources":["../../../../src/app/dashboard/folders/page.tsx","../../../../src/components/folders/FolderList.tsx","../../../../src/components/folders/FolderItem.tsx","../../../../src/components/folders/FolderTree.tsx","../../../../src/components/folders/index.ts","../../../../src/components/folders/FolderSelector.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useCallback, useEffect } from 'react';\r\nimport { DashboardLayout } from '@/components/dashboard/DashboardLayout';\r\nimport { FolderList, Breadcrumbs, buildBreadcrumbsFromPath, BreadcrumbItem } from '@/components/folders';\r\nimport { useFolders, Folder } from '@/lib/hooks/useFolders';\r\n\r\nexport default function FoldersPage() {\r\n  const { folders, fetchFolders } = useFolders();\r\n  const [currentFolderId, setCurrentFolderId] = useState<string | null>(null);\r\n  const [breadcrumbs, setBreadcrumbs] = useState<BreadcrumbItem[]>([\r\n    { id: null, name: 'Root' }\r\n  ]);\r\n\r\n  // Fetch all folders to build breadcrumbs accurately\r\n  useEffect(() => {\r\n    fetchFolders();\r\n  }, [fetchFolders]);\r\n\r\n  // Update breadcrumbs when current folder or folders list changes\r\n  useEffect(() => {\r\n    if (folders.length > 0 || currentFolderId === null) {\r\n      const newBreadcrumbs = buildBreadcrumbsFromPath(folders, currentFolderId);\r\n      setBreadcrumbs(newBreadcrumbs);\r\n    }\r\n  }, [currentFolderId, folders]);\r\n\r\n  const handleFolderClick = useCallback((folder: Folder) => {\r\n    setCurrentFolderId(folder.id);\r\n  }, []);\r\n\r\n  const handleBreadcrumbClick = useCallback((item: BreadcrumbItem) => {\r\n    setCurrentFolderId(item.id);\r\n  }, []);\r\n\r\n  return (\r\n    <DashboardLayout>\r\n      <div className=\"space-y-6\">\r\n        {/* Page Header */}\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold text-gray-900\">Folders</h1>\r\n          <p className=\"mt-1 text-sm text-gray-500\">\r\n            Organize your documents into folders for easy access.\r\n          </p>\r\n        </div>\r\n\r\n        {/* Breadcrumbs */}\r\n        <Breadcrumbs\r\n          items={breadcrumbs}\r\n          onItemClick={handleBreadcrumbClick}\r\n          showHomeIcon={true}\r\n        />\r\n\r\n        {/* Folder List - Requirements 12.2 */}\r\n        <div className=\"rounded-lg bg-white p-6 shadow-sm\">\r\n          <FolderList \r\n            parentId={currentFolderId} \r\n            onFolderClick={handleFolderClick}\r\n            enablePagination={true}\r\n          />\r\n        </div>\r\n      </div>\r\n    </DashboardLayout>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport { useState, useEffect, useCallback } from 'react';\r\nimport { useFolders, Folder } from '@/lib/hooks/useFolders';\r\nimport { FolderItem } from './FolderItem';\r\nimport { CreateFolderModal } from './CreateFolderModal';\r\nimport { RenameFolderModal } from './RenameFolderModal';\r\nimport { MoveFolderModal } from './MoveFolderModal';\r\nimport { ConfirmDialog } from '@/components/ui/ConfirmDialog';\r\nimport { Pagination } from '@/components/ui/Pagination';\r\nimport { FolderGridSkeleton } from '@/components/ui/Skeleton';\r\nimport { useToast } from '@/components/ui/Toast';\r\n\r\ninterface FolderListProps {\r\n  parentId?: string | null;\r\n  onFolderClick?: (folder: Folder) => void;\r\n  enablePagination?: boolean;\r\n}\r\n\r\nexport function FolderList({ parentId = null, onFolderClick, enablePagination = false }: FolderListProps) {\r\n  const { \r\n    folders, \r\n    loading, \r\n    error, \r\n    pagination,\r\n    fetchFolders,\r\n    fetchFoldersPaginated, \r\n    createFolder, \r\n    renameFolder, \r\n    deleteFolder, \r\n    moveFolder,\r\n    setPage,\r\n    setPageSize,\r\n  } = useFolders();\r\n  const toast = useToast();\r\n\r\n  const [showCreateModal, setShowCreateModal] = useState(false);\r\n  const [folderToRename, setFolderToRename] = useState<Folder | null>(null);\r\n  const [folderToMove, setFolderToMove] = useState<Folder | null>(null);\r\n  const [folderToDelete, setFolderToDelete] = useState<Folder | null>(null);\r\n  const [allFolders, setAllFolders] = useState<Folder[]>([]);\r\n\r\n  useEffect(() => {\r\n    if (enablePagination) {\r\n      fetchFoldersPaginated(parentId, pagination.currentPage, pagination.pageSize);\r\n    } else {\r\n      fetchFolders(parentId);\r\n    }\r\n  }, [fetchFolders, fetchFoldersPaginated, parentId, enablePagination, pagination.currentPage, pagination.pageSize]);\r\n\r\n  // Fetch all folders for move modal (without pagination)\r\n  useEffect(() => {\r\n    const fetchAllFolders = async () => {\r\n      try {\r\n        const { getIdToken } = await import('@/lib/hooks/useAuthenticatedFetch');\r\n        const token = await getIdToken();\r\n        if (!token) return;\r\n        \r\n        // We need all folders for the move modal, so fetch without pagination\r\n        const response = await fetch('/api/folders', {\r\n          headers: { 'Authorization': `Bearer ${token}` }\r\n        });\r\n        if (response.ok) {\r\n          const data = await response.json();\r\n          setAllFolders(data.folders || []);\r\n        }\r\n      } catch (error) {\r\n        console.error('Failed to fetch all folders:', error);\r\n      }\r\n    };\r\n    fetchAllFolders();\r\n  }, [folders]);\r\n\r\n  const handleCreateFolder = useCallback(async (name: string) => {\r\n    const result = await createFolder(name, parentId);\r\n    if (result) {\r\n      toast.success(`Folder \"${name}\" created successfully`);\r\n    } else {\r\n      toast.error('Failed to create folder');\r\n      throw new Error('Failed to create folder');\r\n    }\r\n  }, [createFolder, parentId, toast]);\r\n\r\n  const handleRenameFolder = useCallback(async (newName: string) => {\r\n    if (!folderToRename) return;\r\n    const result = await renameFolder(folderToRename.id, newName);\r\n    if (result) {\r\n      toast.success(`Folder renamed to \"${newName}\"`);\r\n    } else {\r\n      toast.error('Failed to rename folder');\r\n      throw new Error('Failed to rename folder');\r\n    }\r\n  }, [renameFolder, folderToRename, toast]);\r\n\r\n  const handleMoveFolder = useCallback(async (newParentId: string | null) => {\r\n    if (!folderToMove) return;\r\n    const result = await moveFolder(folderToMove.id, newParentId);\r\n    if (result) {\r\n      toast.success('Folder moved successfully');\r\n    } else {\r\n      toast.error('Failed to move folder');\r\n      throw new Error('Failed to move folder');\r\n    }\r\n  }, [moveFolder, folderToMove, toast]);\r\n\r\n  const handleDeleteFolder = useCallback(async () => {\r\n    if (!folderToDelete) return;\r\n    const success = await deleteFolder(folderToDelete.id);\r\n    if (success) {\r\n      toast.success(`Folder \"${folderToDelete.name}\" deleted`);\r\n    } else {\r\n      toast.error('Failed to delete folder');\r\n    }\r\n    setFolderToDelete(null);\r\n  }, [deleteFolder, folderToDelete, toast]);\r\n\r\n  const handleFolderClick = useCallback((folder: Folder) => {\r\n    if (onFolderClick) {\r\n      onFolderClick(folder);\r\n    }\r\n  }, [onFolderClick]);\r\n\r\n  const handlePageChange = useCallback((page: number) => {\r\n    setPage(page);\r\n  }, [setPage]);\r\n\r\n  const handlePageSizeChange = useCallback((pageSize: number) => {\r\n    setPageSize(pageSize);\r\n  }, [setPageSize]);\r\n\r\n  // Filter folders by parent (only when not using pagination, as API handles it)\r\n  const displayFolders = enablePagination ? folders : folders.filter(f => f.parent_id === parentId);\r\n\r\n  // Skeleton loading state - Requirements 12.5\r\n  if (loading && folders.length === 0) {\r\n    return (\r\n      <div>\r\n        <div className=\"mb-4 flex items-center justify-between\">\r\n          <h2 className=\"text-lg font-semibold text-gray-900\">Folders</h2>\r\n        </div>\r\n        <FolderGridSkeleton count={6} />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      {/* Header - Requirements 1.3, 6.4: Responsive design */}\r\n      <div className=\"mb-3 sm:mb-4 flex items-center justify-between gap-3\">\r\n        <h2 className=\"text-base sm:text-lg font-semibold text-gray-900\">Folders</h2>\r\n        <button\r\n          onClick={() => setShowCreateModal(true)}\r\n          className=\"flex items-center gap-1.5 sm:gap-2 rounded-lg bg-blue-600 px-3 sm:px-4 py-2 sm:py-2 text-sm font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 active:scale-[0.98]\"\r\n        >\r\n          <svg className=\"h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 4v16m8-8H4\" />\r\n          </svg>\r\n          <span className=\"hidden sm:inline\">New Folder</span>\r\n          <span className=\"sm:hidden\">New</span>\r\n        </button>\r\n      </div>\r\n\r\n      {/* Error Message */}\r\n      {error && (\r\n        <div className=\"mb-4 rounded-lg bg-red-50 p-4 text-sm text-red-600\">\r\n          {error}\r\n        </div>\r\n      )}\r\n\r\n      {/* Folder Grid */}\r\n      {displayFolders.length === 0 ? (\r\n        <div className=\"rounded-lg border-2 border-dashed border-gray-300 p-12 text-center\">\r\n          <svg className=\"mx-auto h-12 w-12 text-gray-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z\" />\r\n          </svg>\r\n          <h3 className=\"mt-4 text-sm font-medium text-gray-900\">No folders</h3>\r\n          <p className=\"mt-1 text-sm text-gray-500\">Get started by creating a new folder.</p>\r\n          <button\r\n            onClick={() => setShowCreateModal(true)}\r\n            className=\"mt-4 inline-flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700\"\r\n          >\r\n            <svg className=\"h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 4v16m8-8H4\" />\r\n            </svg>\r\n            Create Folder\r\n          </button>\r\n        </div>\r\n      ) : (\r\n        <>\r\n          <div className=\"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3\">\r\n            {displayFolders.map(folder => (\r\n              <FolderItem\r\n                key={folder.id}\r\n                folder={folder}\r\n                onRename={setFolderToRename}\r\n                onDelete={setFolderToDelete}\r\n                onMove={setFolderToMove}\r\n                onClick={handleFolderClick}\r\n              />\r\n            ))}\r\n          </div>\r\n\r\n          {/* Pagination - Requirements 12.2 */}\r\n          {enablePagination && pagination.totalPages > 0 && (\r\n            <div className=\"mt-4 sm:mt-6\">\r\n              <Pagination\r\n                currentPage={pagination.currentPage}\r\n                totalPages={pagination.totalPages}\r\n                totalItems={pagination.totalItems}\r\n                pageSize={pagination.pageSize}\r\n                onPageChange={handlePageChange}\r\n                onPageSizeChange={handlePageSizeChange}\r\n                pageSizeOptions={[20, 30, 50]}\r\n              />\r\n            </div>\r\n          )}\r\n        </>\r\n      )}\r\n\r\n      {/* Modals */}\r\n      <CreateFolderModal\r\n        isOpen={showCreateModal}\r\n        onClose={() => setShowCreateModal(false)}\r\n        onCreate={handleCreateFolder}\r\n      />\r\n\r\n      <RenameFolderModal\r\n        isOpen={!!folderToRename}\r\n        currentName={folderToRename?.name || ''}\r\n        onClose={() => setFolderToRename(null)}\r\n        onRename={handleRenameFolder}\r\n      />\r\n\r\n      <MoveFolderModal\r\n        isOpen={!!folderToMove}\r\n        folder={folderToMove}\r\n        allFolders={allFolders.length > 0 ? allFolders : folders}\r\n        onClose={() => setFolderToMove(null)}\r\n        onMove={handleMoveFolder}\r\n      />\r\n\r\n      <ConfirmDialog\r\n        isOpen={!!folderToDelete}\r\n        title=\"Delete Folder\"\r\n        message={`Are you sure you want to delete \"${folderToDelete?.name}\"? This will also delete all contents inside this folder. This action cannot be undone.`}\r\n        confirmLabel=\"Delete\"\r\n        variant=\"danger\"\r\n        onConfirm={handleDeleteFolder}\r\n        onCancel={() => setFolderToDelete(null)}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport { useState, memo, useCallback } from 'react';\r\nimport { Folder } from '@/lib/hooks/useFolders';\r\n\r\ninterface FolderItemProps {\r\n  folder: Folder;\r\n  onRename: (folder: Folder) => void;\r\n  onDelete: (folder: Folder) => void;\r\n  onMove: (folder: Folder) => void;\r\n  onClick: (folder: Folder) => void;\r\n}\r\n\r\n/**\r\n * Memoized folder item component\r\n * Requirements: 12.1, 12.3 - Performance optimization with React.memo\r\n * Accessibility: Keyboard navigation and ARIA labels\r\n */\r\nexport const FolderItem = memo(function FolderItem({\r\n  folder,\r\n  onRename,\r\n  onDelete,\r\n  onMove,\r\n  onClick\r\n}: FolderItemProps) {\r\n  const [showMenu, setShowMenu] = useState(false);\r\n\r\n  const handleMenuClick = useCallback((e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    setShowMenu(prev => !prev);\r\n  }, []);\r\n\r\n  const handleKeyDown = useCallback((e: React.KeyboardEvent) => {\r\n    if (e.key === 'Enter' || e.key === ' ') {\r\n      e.preventDefault();\r\n      onClick(folder);\r\n    }\r\n  }, [folder, onClick]);\r\n\r\n  const handleAction = useCallback((action: () => void) => {\r\n    setShowMenu(false);\r\n    action();\r\n  }, []);\r\n\r\n  const handleClick = useCallback(() => onClick(folder), [folder, onClick]);\r\n  const handleRename = useCallback(() => handleAction(() => onRename(folder)), [folder, onRename, handleAction]);\r\n  const handleMove = useCallback(() => handleAction(() => onMove(folder)), [folder, onMove, handleAction]);\r\n  const handleDelete = useCallback(() => handleAction(() => onDelete(folder)), [folder, onDelete, handleAction]);\r\n\r\n  return (\r\n    <article\r\n      className=\"group relative flex items-center gap-3 rounded-lg border border-gray-200 bg-white p-3 sm:p-4 transition-all hover:border-blue-300 hover:shadow-md cursor-pointer active:scale-[0.99] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2\"\r\n      onClick={handleClick}\r\n      onKeyDown={handleKeyDown}\r\n      tabIndex={0}\r\n      role=\"button\"\r\n      aria-label={`Open folder ${folder.name}`}\r\n    >\r\n      {/* Folder Icon - Requirements 1.3, 6.4: Responsive design */}\r\n      <div className=\"flex h-10 w-10 sm:h-12 sm:w-12 flex-shrink-0 items-center justify-center rounded-lg bg-gradient-to-r from-blue-100 to-purple-100\" aria-hidden=\"true\">\r\n        <svg className=\"h-5 w-5 sm:h-6 sm:w-6 text-blue-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" aria-hidden=\"true\">\r\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z\" />\r\n        </svg>\r\n      </div>\r\n\r\n      {/* Folder Info */}\r\n      <div className=\"flex-1 min-w-0\">\r\n        <h3 className=\"text-sm font-medium text-gray-900 truncate\">{folder.name}</h3>\r\n        <p className=\"text-xs text-gray-500 truncate\">{folder.path}</p>\r\n      </div>\r\n\r\n      {/* Actions Menu - always visible on mobile for touch accessibility */}\r\n      <div className=\"relative\">\r\n        <button\r\n          onClick={handleMenuClick}\r\n          className=\"rounded-lg p-2.5 sm:p-2 text-gray-400 sm:opacity-0 transition-opacity hover:bg-gray-100 hover:text-gray-600 group-hover:opacity-100 active:scale-95 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 focus-visible:opacity-100\"\r\n          aria-label={`Actions for folder ${folder.name}`}\r\n          aria-expanded={showMenu}\r\n          aria-haspopup=\"menu\"\r\n        >\r\n          <svg className=\"h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" aria-hidden=\"true\">\r\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z\" />\r\n          </svg>\r\n        </button>\r\n\r\n        {showMenu && (\r\n          <>\r\n            <div \r\n              className=\"fixed inset-0 z-10\" \r\n              onClick={(e) => { e.stopPropagation(); setShowMenu(false); }}\r\n              aria-hidden=\"true\"\r\n            />\r\n            <div \r\n              className=\"absolute right-0 top-full z-20 mt-1 w-40 rounded-lg border border-gray-200 bg-white py-1 shadow-lg\"\r\n              role=\"menu\"\r\n              aria-label={`Actions for ${folder.name}`}\r\n            >\r\n              <button\r\n                onClick={(e) => { e.stopPropagation(); handleRename(); }}\r\n                className=\"flex w-full items-center gap-2 px-4 py-2.5 sm:py-2 text-sm text-gray-700 hover:bg-gray-100 active:bg-gray-200 focus-visible:outline-none focus-visible:bg-gray-100\"\r\n                role=\"menuitem\"\r\n              >\r\n                <svg className=\"h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" aria-hidden=\"true\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\" />\r\n                </svg>\r\n                Rename\r\n              </button>\r\n              <button\r\n                onClick={(e) => { e.stopPropagation(); handleMove(); }}\r\n                className=\"flex w-full items-center gap-2 px-4 py-2.5 sm:py-2 text-sm text-gray-700 hover:bg-gray-100 active:bg-gray-200 focus-visible:outline-none focus-visible:bg-gray-100\"\r\n                role=\"menuitem\"\r\n              >\r\n                <svg className=\"h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" aria-hidden=\"true\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4\" />\r\n                </svg>\r\n                Move\r\n              </button>\r\n              <hr className=\"my-1 border-gray-200\" role=\"separator\" />\r\n              <button\r\n                onClick={(e) => { e.stopPropagation(); handleDelete(); }}\r\n                className=\"flex w-full items-center gap-2 px-4 py-2.5 sm:py-2 text-sm text-red-600 hover:bg-red-50 active:bg-red-100 focus-visible:outline-none focus-visible:bg-red-50\"\r\n                role=\"menuitem\"\r\n              >\r\n                <svg className=\"h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" aria-hidden=\"true\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\r\n                </svg>\r\n                Delete\r\n              </button>\r\n            </div>\r\n          </>\r\n        )}\r\n      </div>\r\n    </article>\r\n  );\r\n});\r\n","\"use client\";\r\n\r\nimport { useState, useCallback } from 'react';\r\nimport { Folder } from '@/lib/hooks/useFolders';\r\n\r\ninterface FolderTreeNodeProps {\r\n  folder: Folder;\r\n  allFolders: Folder[];\r\n  level: number;\r\n  expandedIds: Set<string>;\r\n  selectedIds: Set<string>;\r\n  onToggleExpand: (id: string) => void;\r\n  onToggleSelect?: (id: string) => void;\r\n  onFolderClick?: (folder: Folder) => void;\r\n  selectable?: boolean;\r\n}\r\n\r\nfunction FolderTreeNode({\r\n  folder,\r\n  allFolders,\r\n  level,\r\n  expandedIds,\r\n  selectedIds,\r\n  onToggleExpand,\r\n  onToggleSelect,\r\n  onFolderClick,\r\n  selectable = false,\r\n}: FolderTreeNodeProps) {\r\n  const children = allFolders.filter(f => f.parent_id === folder.id);\r\n  const hasChildren = children.length > 0;\r\n  const isExpanded = expandedIds.has(folder.id);\r\n  const isSelected = selectedIds.has(folder.id);\r\n\r\n  const handleExpandClick = (e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    onToggleExpand(folder.id);\r\n  };\r\n\r\n  const handleCheckboxChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    e.stopPropagation();\r\n    onToggleSelect?.(folder.id);\r\n  };\r\n\r\n  const handleFolderClick = () => {\r\n    onFolderClick?.(folder);\r\n  };\r\n\r\n  return (\r\n    <div className=\"select-none\">\r\n      <div\r\n        className={`flex items-center gap-2 rounded-md px-2 py-1.5 transition-colors hover:bg-gray-100 cursor-pointer ${\r\n          isSelected && !selectable ? 'bg-blue-50' : ''\r\n        }`}\r\n        style={{ paddingLeft: `${level * 16 + 8}px` }}\r\n        onClick={handleFolderClick}\r\n      >\r\n        {/* Expand/Collapse Button */}\r\n        <button\r\n          onClick={handleExpandClick}\r\n          className={`flex h-5 w-5 items-center justify-center rounded transition-colors hover:bg-gray-200 ${\r\n            !hasChildren ? 'invisible' : ''\r\n          }`}\r\n          aria-label={isExpanded ? 'Collapse folder' : 'Expand folder'}\r\n        >\r\n          <svg\r\n            className={`h-4 w-4 text-gray-500 transition-transform ${isExpanded ? 'rotate-90' : ''}`}\r\n            fill=\"none\"\r\n            stroke=\"currentColor\"\r\n            viewBox=\"0 0 24 24\"\r\n          >\r\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" />\r\n          </svg>\r\n        </button>\r\n\r\n        {/* Checkbox for selection (AI features) */}\r\n        {selectable && (\r\n          <input\r\n            type=\"checkbox\"\r\n            checked={isSelected}\r\n            onChange={handleCheckboxChange}\r\n            onClick={(e) => e.stopPropagation()}\r\n            className=\"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\r\n            aria-label={`Select ${folder.name}`}\r\n          />\r\n        )}\r\n\r\n        {/* Folder Icon */}\r\n        <svg\r\n          className={`h-5 w-5 flex-shrink-0 ${isExpanded ? 'text-blue-500' : 'text-gray-400'}`}\r\n          fill=\"none\"\r\n          stroke=\"currentColor\"\r\n          viewBox=\"0 0 24 24\"\r\n        >\r\n          {isExpanded ? (\r\n            <path\r\n              strokeLinecap=\"round\"\r\n              strokeLinejoin=\"round\"\r\n              strokeWidth={2}\r\n              d=\"M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z\"\r\n            />\r\n          ) : (\r\n            <path\r\n              strokeLinecap=\"round\"\r\n              strokeLinejoin=\"round\"\r\n              strokeWidth={2}\r\n              d=\"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z\"\r\n            />\r\n          )}\r\n        </svg>\r\n\r\n        {/* Folder Name */}\r\n        <span className=\"truncate text-sm text-gray-700\">{folder.name}</span>\r\n      </div>\r\n\r\n      {/* Children */}\r\n      {hasChildren && isExpanded && (\r\n        <div>\r\n          {children.map(child => (\r\n            <FolderTreeNode\r\n              key={child.id}\r\n              folder={child}\r\n              allFolders={allFolders}\r\n              level={level + 1}\r\n              expandedIds={expandedIds}\r\n              selectedIds={selectedIds}\r\n              onToggleExpand={onToggleExpand}\r\n              onToggleSelect={onToggleSelect}\r\n              onFolderClick={onFolderClick}\r\n              selectable={selectable}\r\n            />\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport interface FolderTreeProps {\r\n  folders: Folder[];\r\n  selectedIds?: Set<string>;\r\n  onSelectionChange?: (selectedIds: Set<string>) => void;\r\n  onFolderClick?: (folder: Folder) => void;\r\n  selectable?: boolean;\r\n  defaultExpandedIds?: string[];\r\n  className?: string;\r\n}\r\n\r\nexport function FolderTree({\r\n  folders,\r\n  selectedIds: controlledSelectedIds,\r\n  onSelectionChange,\r\n  onFolderClick,\r\n  selectable = false,\r\n  defaultExpandedIds = [],\r\n  className = '',\r\n}: FolderTreeProps) {\r\n  const [expandedIds, setExpandedIds] = useState<Set<string>>(new Set(defaultExpandedIds));\r\n  const [internalSelectedIds, setInternalSelectedIds] = useState<Set<string>>(new Set());\r\n\r\n  // Use controlled or internal selection state\r\n  const selectedIds = controlledSelectedIds ?? internalSelectedIds;\r\n\r\n  const rootFolders = folders.filter(f => f.parent_id === null);\r\n\r\n  const handleToggleExpand = useCallback((id: string) => {\r\n    setExpandedIds(prev => {\r\n      const next = new Set(prev);\r\n      if (next.has(id)) {\r\n        next.delete(id);\r\n      } else {\r\n        next.add(id);\r\n      }\r\n      return next;\r\n    });\r\n  }, []);\r\n\r\n  const handleToggleSelect = useCallback((id: string) => {\r\n    const newSelectedIds = new Set(selectedIds);\r\n    if (newSelectedIds.has(id)) {\r\n      newSelectedIds.delete(id);\r\n    } else {\r\n      newSelectedIds.add(id);\r\n    }\r\n    \r\n    if (onSelectionChange) {\r\n      onSelectionChange(newSelectedIds);\r\n    } else {\r\n      setInternalSelectedIds(newSelectedIds);\r\n    }\r\n  }, [selectedIds, onSelectionChange]);\r\n\r\n  // Expand all folders\r\n  const expandAll = useCallback(() => {\r\n    setExpandedIds(new Set(folders.map(f => f.id)));\r\n  }, [folders]);\r\n\r\n  // Collapse all folders\r\n  const collapseAll = useCallback(() => {\r\n    setExpandedIds(new Set());\r\n  }, []);\r\n\r\n  // Select all folders\r\n  const selectAll = useCallback(() => {\r\n    const allIds = new Set(folders.map(f => f.id));\r\n    if (onSelectionChange) {\r\n      onSelectionChange(allIds);\r\n    } else {\r\n      setInternalSelectedIds(allIds);\r\n    }\r\n  }, [folders, onSelectionChange]);\r\n\r\n  // Deselect all folders\r\n  const deselectAll = useCallback(() => {\r\n    const emptySet = new Set<string>();\r\n    if (onSelectionChange) {\r\n      onSelectionChange(emptySet);\r\n    } else {\r\n      setInternalSelectedIds(emptySet);\r\n    }\r\n  }, [onSelectionChange]);\r\n\r\n  if (folders.length === 0) {\r\n    return (\r\n      <div className={`rounded-lg border-2 border-dashed border-gray-300 p-8 text-center ${className}`}>\r\n        <svg className=\"mx-auto h-10 w-10 text-gray-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z\" />\r\n        </svg>\r\n        <p className=\"mt-2 text-sm text-gray-500\">No folders available</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className={className}>\r\n      {/* Action Buttons */}\r\n      <div className=\"mb-3 flex items-center gap-2\">\r\n        <button\r\n          onClick={expandAll}\r\n          className=\"text-xs text-blue-600 hover:text-blue-800 hover:underline\"\r\n        >\r\n          Expand All\r\n        </button>\r\n        <span className=\"text-gray-300\">|</span>\r\n        <button\r\n          onClick={collapseAll}\r\n          className=\"text-xs text-blue-600 hover:text-blue-800 hover:underline\"\r\n        >\r\n          Collapse All\r\n        </button>\r\n        {selectable && (\r\n          <>\r\n            <span className=\"text-gray-300\">|</span>\r\n            <button\r\n              onClick={selectAll}\r\n              className=\"text-xs text-blue-600 hover:text-blue-800 hover:underline\"\r\n            >\r\n              Select All\r\n            </button>\r\n            <span className=\"text-gray-300\">|</span>\r\n            <button\r\n              onClick={deselectAll}\r\n              className=\"text-xs text-blue-600 hover:text-blue-800 hover:underline\"\r\n            >\r\n              Deselect All\r\n            </button>\r\n          </>\r\n        )}\r\n      </div>\r\n\r\n      {/* Selection Count */}\r\n      {selectable && selectedIds.size > 0 && (\r\n        <div className=\"mb-2 text-sm text-gray-600\">\r\n          {selectedIds.size} folder{selectedIds.size !== 1 ? 's' : ''} selected\r\n        </div>\r\n      )}\r\n\r\n      {/* Tree */}\r\n      <div className=\"rounded-lg border border-gray-200 bg-white\">\r\n        {rootFolders.map(folder => (\r\n          <FolderTreeNode\r\n            key={folder.id}\r\n            folder={folder}\r\n            allFolders={folders}\r\n            level={0}\r\n            expandedIds={expandedIds}\r\n            selectedIds={selectedIds}\r\n            onToggleExpand={handleToggleExpand}\r\n            onToggleSelect={handleToggleSelect}\r\n            onFolderClick={onFolderClick}\r\n            selectable={selectable}\r\n          />\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","export { FolderList } from './FolderList';\r\nexport { FolderItem } from './FolderItem';\r\nexport { CreateFolderModal } from './CreateFolderModal';\r\nexport { RenameFolderModal } from './RenameFolderModal';\r\nexport { MoveFolderModal } from './MoveFolderModal';\r\nexport { FolderTree } from './FolderTree';\r\nexport { Breadcrumbs, buildBreadcrumbsFromPath } from './Breadcrumbs';\r\nexport { FolderSelector } from './FolderSelector';\r\nexport type { BreadcrumbItem } from './Breadcrumbs';\r\nexport type { FolderTreeProps } from './FolderTree';\r\n","\"use client\";\r\n\r\nimport { useState, useEffect, useCallback } from 'react';\r\nimport { useFolders } from '@/lib/hooks/useFolders';\r\nimport { FolderTree } from './FolderTree';\r\n\r\ninterface FolderSelectorProps {\r\n  onSelectionChange: (selectedFolderIds: string[]) => void;\r\n  selectedFolderIds?: string[];\r\n  className?: string;\r\n  title?: string;\r\n  description?: string;\r\n}\r\n\r\nexport function FolderSelector({\r\n  onSelectionChange,\r\n  selectedFolderIds: controlledSelectedIds,\r\n  className = '',\r\n  title = 'Select Folders',\r\n  description = 'Choose folders containing documents for AI processing',\r\n}: FolderSelectorProps) {\r\n  const { folders, loading, error, fetchFolders } = useFolders();\r\n  const [selectedIds, setSelectedIds] = useState<Set<string>>(\r\n    new Set(controlledSelectedIds || [])\r\n  );\r\n\r\n  // Fetch all folders on mount\r\n  useEffect(() => {\r\n    fetchFolders();\r\n  }, [fetchFolders]);\r\n\r\n  // Sync with controlled prop\r\n  useEffect(() => {\r\n    if (controlledSelectedIds) {\r\n      setSelectedIds(new Set(controlledSelectedIds));\r\n    }\r\n  }, [controlledSelectedIds]);\r\n\r\n  const handleSelectionChange = useCallback(\r\n    (newSelectedIds: Set<string>) => {\r\n      setSelectedIds(newSelectedIds);\r\n      onSelectionChange(Array.from(newSelectedIds));\r\n    },\r\n    [onSelectionChange]\r\n  );\r\n\r\n  const handleSelectAll = useCallback(() => {\r\n    const allIds = new Set(folders.map(f => f.id));\r\n    setSelectedIds(allIds);\r\n    onSelectionChange(Array.from(allIds));\r\n  }, [folders, onSelectionChange]);\r\n\r\n  const handleDeselectAll = useCallback(() => {\r\n    setSelectedIds(new Set());\r\n    onSelectionChange([]);\r\n  }, [onSelectionChange]);\r\n\r\n  if (loading && folders.length === 0) {\r\n    return (\r\n      <div className={`rounded-lg border border-gray-200 bg-white p-6 ${className}`}>\r\n        <div className=\"flex items-center justify-center py-8\">\r\n          <div className=\"h-8 w-8 animate-spin rounded-full border-4 border-blue-600 border-t-transparent\" />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className={`rounded-lg border border-red-200 bg-red-50 p-6 ${className}`}>\r\n        <p className=\"text-sm text-red-600\">{error}</p>\r\n        <button\r\n          onClick={() => fetchFolders()}\r\n          className=\"mt-2 text-sm text-red-700 underline hover:no-underline\"\r\n        >\r\n          Try again\r\n        </button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className={`rounded-lg border border-gray-200 bg-white p-6 ${className}`}>\r\n      {/* Header */}\r\n      <div className=\"mb-4\">\r\n        <h3 className=\"text-lg font-semibold text-gray-900\">{title}</h3>\r\n        <p className=\"mt-1 text-sm text-gray-500\">{description}</p>\r\n      </div>\r\n\r\n      {/* Quick Actions */}\r\n      <div className=\"mb-4 flex items-center gap-3\">\r\n        <button\r\n          onClick={handleSelectAll}\r\n          className=\"rounded-md bg-blue-50 px-3 py-1.5 text-sm font-medium text-blue-700 hover:bg-blue-100 transition-colors\"\r\n        >\r\n          Select All\r\n        </button>\r\n        <button\r\n          onClick={handleDeselectAll}\r\n          className=\"rounded-md bg-gray-50 px-3 py-1.5 text-sm font-medium text-gray-700 hover:bg-gray-100 transition-colors\"\r\n        >\r\n          Deselect All\r\n        </button>\r\n        {selectedIds.size > 0 && (\r\n          <span className=\"text-sm text-gray-500\">\r\n            {selectedIds.size} folder{selectedIds.size !== 1 ? 's' : ''} selected\r\n          </span>\r\n        )}\r\n      </div>\r\n\r\n      {/* Folder Tree */}\r\n      <FolderTree\r\n        folders={folders}\r\n        selectedIds={selectedIds}\r\n        onSelectionChange={handleSelectionChange}\r\n        selectable={true}\r\n      />\r\n\r\n      {/* Selected Folders Summary */}\r\n      {selectedIds.size > 0 && (\r\n        <div className=\"mt-4 rounded-lg bg-blue-50 p-4\">\r\n          <h4 className=\"text-sm font-medium text-blue-900\">Selected Folders:</h4>\r\n          <div className=\"mt-2 flex flex-wrap gap-2\">\r\n            {Array.from(selectedIds).map(id => {\r\n              const folder = folders.find(f => f.id === id);\r\n              if (!folder) return null;\r\n              return (\r\n                <span\r\n                  key={id}\r\n                  className=\"inline-flex items-center gap-1 rounded-full bg-blue-100 px-3 py-1 text-sm text-blue-800\"\r\n                >\r\n                  <svg\r\n                    className=\"h-3.5 w-3.5\"\r\n                    fill=\"none\"\r\n                    stroke=\"currentColor\"\r\n                    viewBox=\"0 0 24 24\"\r\n                  >\r\n                    <path\r\n                      strokeLinecap=\"round\"\r\n                      strokeLinejoin=\"round\"\r\n                      strokeWidth={2}\r\n                      d=\"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z\"\r\n                    />\r\n                  </svg>\r\n                  {folder.name}\r\n                  <button\r\n                    onClick={() => {\r\n                      const newIds = new Set(selectedIds);\r\n                      newIds.delete(id);\r\n                      handleSelectionChange(newIds);\r\n                    }}\r\n                    className=\"ml-1 rounded-full p-0.5 hover:bg-blue-200\"\r\n                    aria-label={`Remove ${folder.name}`}\r\n                  >\r\n                    <svg\r\n                      className=\"h-3 w-3\"\r\n                      fill=\"none\"\r\n                      stroke=\"currentColor\"\r\n                      viewBox=\"0 0 24 24\"\r\n                    >\r\n                      <path\r\n                        strokeLinecap=\"round\"\r\n                        strokeLinejoin=\"round\"\r\n                        strokeWidth={2}\r\n                        d=\"M6 18L18 6M6 6l12 12\"\r\n                      />\r\n                    </svg>\r\n                  </button>\r\n                </span>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}